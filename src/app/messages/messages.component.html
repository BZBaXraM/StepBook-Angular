<div class="container mx-auto mt-8 px-4">
	<div class="flex justify-center mb-6">
		<div class="inline-flex rounded-md shadow-sm" role="group">
			<button
				class="px-6 py-3 text-sm font-medium text-white bg-gradient-to-r from-purple-600 to-indigo-600 rounded-l-lg hover:bg-gradient-to-br focus:ring-4 focus:outline-none focus:ring-purple-300 dark:focus:ring-purple-800 transition-all duration-300 ease-in-out"
				btnRadio="Unread"
				[(ngModel)]="container"
				(click)="getMessages()"
			>
				Unread
			</button>
			<button
				class="px-6 py-3 text-sm font-medium text-white bg-gradient-to-r from-indigo-600 to-blue-600 hover:bg-gradient-to-br focus:ring-4 focus:outline-none focus:ring-blue-300 dark:focus:ring-blue-800 transition-all duration-300 ease-in-out"
				btnRadio="Inbox"
				[(ngModel)]="container"
				(click)="getMessages()"
			>
				Inbox
			</button>
			<button
				class="px-6 py-3 text-sm font-medium text-white bg-gradient-to-r from-blue-600 to-cyan-600 rounded-r-lg hover:bg-gradient-to-br focus:ring-4 focus:outline-none focus:ring-cyan-300 dark:focus:ring-cyan-800 transition-all duration-300 ease-in-out"
				btnRadio="Outbox"
				[(ngModel)]="container"
				(click)="getMessages()"
			>
				Outbox
			</button>
		</div>
	</div>

	@if (!messageService.paginatedResult()?.items ||
	messageService.paginatedResult()?.items?.length === 0) {
	<div class="text-center py-8">
		<h3 class="text-2xl font-semibold text-gray-700 dark:text-gray-300">
			No messages
		</h3>
	</div>
	} @else {
	<div class="overflow-x-auto shadow-md sm:rounded-lg">
		<table
			class="w-full text-sm text-left text-gray-500 dark:text-gray-400"
		>
			<thead
				class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"
			>
				<tr>
					<th scope="col" class="px-6 py-3 w-2/5">Message</th>
					<th scope="col" class="px-6 py-3 w-1/5">From / To</th>
					<th scope="col" class="px-6 py-3 w-1/5">Sent / Received</th>
					<th scope="col" class="px-6 py-3 w-1/5">Action</th>
				</tr>
			</thead>
			<tbody>
				@for (item of messageService.paginatedResult()?.items; track
				item.id) {
				<tr
					class="bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 transition-all duration-200 ease-in-out"
					routerLink="{{ getRoute(item) }}"
					[queryParams]="{ tab: 'Messages' }"
				>
					<td class="px-6 py-4">{{ item.Content }}</td>
					<td class="px-6 py-4">
						<div class="flex items-center space-x-3">
							<img
								class="rounded-full h-10 w-10 object-cover"
								[src]="
									isOutbox
										? item.recipientPhotoUrl || 'user.png'
										: item.senderPhotoUrl || 'user.png'
								"
								alt="User avatar"
							/>
							<span class="font-medium">{{
								isOutbox
									? item.RecipientUsername
									: item.SenderUsername
							}}</span>
						</div>
					</td>
					<td class="px-6 py-4">
						{{
							item.MessageSent
								? (item.MessageSent | timeago)
								: "Unknown time"
						}}
					</td>
					<td
						class="px-6 py-4"
						(click)="$event.stopImmediatePropagation()"
					>
						<button
							class="font-medium text-red-600 dark:text-red-500 hover:underline"
							(click)="deleteMessage(item.Id)"
						>
							Delete
						</button>
					</td>
				</tr>
				}
			</tbody>
		</table>
	</div>
	} @if (messageService.paginatedResult()?.pagination &&
	messageService.paginatedResult()?.pagination?.totalItems! > 0) {
	<div class="flex justify-center mt-6">
		<pagination
			class="flex justify-center"
			[boundaryLinks]="true"
			[totalItems]="
				(messageService.paginatedResult()?.pagination)!.totalItems
			"
			[itemsPerPage]="
				(messageService.paginatedResult()?.pagination)!.itemsPerPage
			"
			(pageChanged)="pageChanged($event)"
			[(ngModel)]="
				(messageService.paginatedResult()?.pagination)!.currentPage
			"
			[maxSize]="10"
			previousText="&lsaquo;"
			nextText="&rsaquo;"
			firstText="&laquo;"
			lastText="&raquo;"
		>
		</pagination>
	</div>
	}
</div>
