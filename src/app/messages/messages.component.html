<div class="container mt-3">
	<div class="d-flex">
		<div class="btn-group">
			<button class="btn btn-primary" btnRadio="Unread" [(ngModel)]="container"
				(click)="getMessages()">Unread</button>
			<button class="btn btn-primary" btnRadio="Inbox" [(ngModel)]="container"
				(click)="getMessages()">Inbox</button>
			<button class="btn btn-primary" btnRadio="Outbox" [(ngModel)]="container"
				(click)="getMessages()">Outbox</button>
		</div>
	</div>
</div>

@if (!messageService.paginatedResult()?.items || messageService.paginatedResult()?.items?.length === 0) {
<h3>No messages</h3>
} @else {
<table class="table table-hover mt-3" style="cursor: pointer;">
	<thead>
		<tr>
			<th style="width: 40%;">Message</th>
			<th style="width: 20%;">From / To</th>
			<th style="width: 20%;">Sent / Received</th>
			<th style="width: 20%;"></th>
		</tr>
	</thead>
	<tbody class="align-middle">
		@for (item of messageService.paginatedResult()?.items; track item.Id) {
		<tr routerLink="{{getRoute(item)}}" [queryParams]="{tab: 'Messages'}">
			<td>{{ item.Content }}</td>
			<td>
				<div>
					<img class="rounded-circle me-2" [src]="container === 'Outbox'
												? (item.RecipientPhotoUrl || 'user.png')
												: (item.SenderPhotoUrl || 'user.png')" alt="img of user">

					<strong>{{ container === 'Outbox'
						? item.RecipientUsername
						: item.SenderUsername }}</strong>
				</div>
			</td>
			<td>{{ item.MessageSent | timeago }}</td>
			<td>
				<button class="btn btn-danger" (click)="messageService.deleteMessage(item.Id)">Delete</button>
			</td>
		</tr>
		}
	</tbody>
</table>
}

@if (messageService.paginatedResult()?.pagination) {
<div class="pagination-container">

	<pagination [boundaryLinks]="true" [totalItems]="messageService.paginatedResult()?.pagination!.totalItems"
		[itemsPerPage]="messageService.paginatedResult()?.pagination!.itemsPerPage" (pageChanged)="pageChanged($event)"
		[(ngModel)]="messageService.paginatedResult()?.pagination!.currentPage" [maxSize]="10" previousText="&lsaquo;"
		[maxSize]="10" previousText="&lsaquo;" nextText="&rsaquo;" firstText="&laquo;" lastText="&raquo;">
	</pagination>
</div>

}
