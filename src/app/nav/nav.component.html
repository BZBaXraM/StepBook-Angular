<nav
	class="bg-gradient-to-r from-indigo-600 to-purple-600 shadow-lg sticky top-0 z-50"
>
	<div class="container mx-auto px-4">
		<div class="flex items-center justify-between h-16">
			<a
				href="/"
				class="flex items-center gap-2 text-2xl font-bold text-white hover:text-white/90 transition-colors"
			>
				<img src="Logo 3.svg" class="h-10 w-10" alt="Logo" />
				{{ title }}
			</a>

			@if (accountService.currentUser()) {
			<div class="hidden md:flex items-center gap-6">
				<a
					routerLink="/members"
					routerLinkActive="bg-white/10"
					class="flex items-center gap-2 px-4 py-2 text-white hover:bg-white/5 rounded-lg transition-colors"
				>
					<span class="material-icons">home</span>
					Home
				</a>

				<a
					routerLink="/lists"
					routerLinkActive="bg-white/10"
					class="flex items-center gap-2 px-4 py-2 text-white hover:bg-white/5 rounded-lg transition-colors"
				>
					<span class="material-icons">list</span>
					Lists
				</a>

				<a
					routerLink="/search"
					routerLinkActive="bg-white/10"
					class="flex items-center gap-2 px-4 py-2 text-white hover:bg-white/5 rounded-lg transition-colors"
				>
					<span class="material-icons">search</span>
					Search
				</a>

				<a
					routerLink="/messages"
					routerLinkActive="bg-white/10"
					class="flex items-center gap-2 px-4 py-2 text-white hover:bg-white/5 rounded-lg transition-colors relative"
				>
					<span class="material-icons">mail</span>
					Messages @if (haveMessages) {
					<span
						class="absolute -top-1 -right-1 bg-red-500 text-white text-xs w-5 h-5 flex items-center justify-center rounded-full"
					>
						{{ newMessagesCount }}
					</span>
					}
				</a>

				<button
					[matMenuTriggerFor]="menu"
					class="flex items-center gap-2 px-3 py-1.5 bg-white/10 hover:bg-white/15 rounded-full transition-colors"
				>
					<img
						[src]="
							accountService.currentUser()?.PhotoUrl || 'user.png'
						"
						class="w-8 h-8 rounded-full border-2 border-white/50"
						alt="Profile"
					/>
					<span class="text-white">{{
						accountService.currentUser()?.FirstName
					}}</span>
					<span class="material-icons text-white"
						>arrow_drop_down</span
					>
				</button>

				<mat-menu #menu="matMenu" class="mt-2">
					<a
						mat-menu-item
						routerLink="/member/edit"
						class="flex items-center gap-3 px-4 py-3 hover:bg-slate-50"
					>
						<span class="material-icons">edit</span>
						Edit Profile
					</a>
					<a
						mat-menu-item
						routerLink="/account-settings"
						class="flex items-center gap-3 px-4 py-3 hover:bg-slate-50"
					>
						<span class="material-icons">settings</span>
						Account Settings
					</a>
					<div class="border-t border-slate-100 my-2"></div>
					<ng-container *appHasRole="['Admin']">
						<a
							mat-menu-item
							routerLink="/tron"
							class="flex items-center gap-3 px-4 py-3 hover:bg-slate-50"
						>
							<span class="material-icons"
								>admin_panel_settings</span
							>
							Tron
						</a>
					</ng-container>
					<button
						mat-menu-item
						(click)="logout()"
						class="flex items-center gap-3 px-4 py-3 text-red-600 hover:bg-red-50"
					>
						<span class="material-icons">exit_to_app</span>
						Logout
					</button>
				</mat-menu>
			</div>

			<button (click)="toggleMenu()" class="md:hidden text-white">
				<span class="material-icons">{{
					isMenuOpen ? "close" : "menu"
				}}</span>
			</button>

			<div
				class="fixed inset-0 bg-black/50 md:hidden transition-opacity"
				[class.opacity-100]="isMenuOpen"
				[class.opacity-0]="!isMenuOpen"
				[class.pointer-events-auto]="isMenuOpen"
				[class.pointer-events-none]="!isMenuOpen"
			>
				<div
					class="absolute right-0 top-0 h-full w-64 bg-white shadow-xl transform transition-transform"
					[class.translate-x-0]="isMenuOpen"
					[class.translate-x-full]="!isMenuOpen"
				>
					<div class="p-6 border-b border-slate-100">
						<div class="flex items-center gap-3">
							<img
								[src]="
									accountService.currentUser()?.PhotoUrl ||
									'user.png'
								"
								class="w-12 h-12 rounded-full border-2 border-indigo-600"
								alt="Profile"
							/>
							<span class="text-lg font-medium">
								{{ accountService.currentUser()?.FirstName }}
							</span>
						</div>
					</div>

					<nav class="p-4 flex flex-col gap-2">
						<a
							routerLink="/members"
							routerLinkActive="bg-slate-50 text-indigo-600"
							class="flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-slate-50 transition-colors"
							(click)="toggleMenu()"
						>
							<span class="material-icons">home</span>
							Home
						</a>

						<a
							routerLink="/lists"
							routerLinkActive="bg-slate-50 text-indigo-600"
							class="flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-slate-50 transition-colors"
							(click)="toggleMenu()"
						>
							<span class="material-icons">list</span>
							Lists
						</a>

						<a
							routerLink="/search"
							routerLinkActive="bg-slate-50 text-indigo-600"
							class="flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-slate-50 transition-colors"
							(click)="toggleMenu()"
						>
							<span class="material-icons">search</span>
							Search
						</a>

						<a
							routerLink="/messages"
							routerLinkActive="bg-slate-50 text-indigo-600"
							class="flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-slate-50 transition-colors relative"
							(click)="toggleMenu()"
						>
							<span class="material-icons">mail</span>
							Messages @if (haveMessages) {
							<span
								class="absolute right-4 bg-red-500 text-white text-xs w-5 h-5 flex items-center justify-center rounded-full"
							>
								{{ newMessagesCount }}
							</span>
							}
						</a>

						<div class="border-t border-slate-100 my-2"></div>

						<a
							routerLink="/member/edit"
							class="flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-slate-50 transition-colors"
							(click)="toggleMenu()"
						>
							<span class="material-icons">edit</span>
							Edit Profile
						</a>

						<a
							routerLink="/account-settings"
							class="flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-slate-50 transition-colors"
							(click)="toggleMenu()"
						>
							<span class="material-icons">settings</span>
							Account Settings
						</a>

						<ng-container *appHasRole="['Admin']">
							<a
								routerLink="/tron"
								class="flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-slate-50 transition-colors"
								(click)="toggleMenu()"
							>
								<span class="material-icons"
									>admin_panel_settings</span
								>
								Tron
							</a>
						</ng-container>

						<button
							(click)="logout()"
							class="flex items-center gap-3 px-4 py-3 text-red-600 rounded-lg hover:bg-red-50 transition-colors w-full text-left"
						>
							<span class="material-icons">exit_to_app</span>
							Logout
						</button>
					</nav>
				</div>
			</div>
			}
		</div>
	</div>
</nav>
